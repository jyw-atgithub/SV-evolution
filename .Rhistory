p + geom_density_2d()
p + geom_smooth()
p + geom_point() + geom_smooth()
p +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(facets = 'Position', nrow = 3)
p + geom_point() + geom_smooth()
p + geom_point(method = lm) + geom_smooth()
p + geom_point() + geom_smooth()
p + geom_point(method = lm) + geom_smooth()
p + geom_point(method = lm, se = FALSE) + geom_smooth()
p + geom_point() + geom_smooth(method = lm, se = FALSE)
p + geom_point() + geom_smooth(method = lm)
mlb.df$HeightBin <- with(
data = mlb.df,
expr = cut(Height, breaks = c(min(Height), 72, max(Height)), include.lowest = TRUE)
)
p <- ggplot(aes(x = Height),
data = subset(x = mlb.df, subset = Position %in% c('Starting_Pitcher', 'Second_Baseman'))
)
mlb.df$HeightBin <- with(
data = mlb.df,
expr = cut(Height, breaks = c(min(Height), 72, max(Height)), include.lowest = TRUE)
)
p <- ggplot(aes(x = Height),
data = subset(x = mlb.df, subset = Position %in% c('Starting_Pitcher', 'Second_Baseman'))
)
p + geom_histogram()
p + geom_histogram(aes(fill = Position))
p + geom_histogram(aes(fill = Position), bins = 10)
p + geom_histogram(aes(fill = Position), binwidth = 10)
p + geom_histogram(aes(fill = Position), bins = 10)
p + geom_density(aes(color = Position))
p + geom_density(aes(color = Team))
p + geom_density(aes(color = Position))
p + geom_histogram()
p + geom_histogram(aes(fill = Position), bins = 10)
p + geom_histogram(aes(fill = Position))
p + geom_histogram(mapping = aes(fill = Position), position = "dodge")
p <- ggplot(data = subset(
x = mlb.df, subset = Position %in% c('Starting_Pitcher', 'Second_Baseman')))
p +
geom_density(aes(x = Weight)) +
facet_grid(facets = Position ~ HeightBin)
let.df <- data.frame(name = rep(letters, 1:26))
ggplot() + geom_bar(mapping = aes(x = name), data = let.df)
ggplot(data = let.df, mapping = aes(x = name)) + geom_bar()
ggplot() + stat_count(mapping = aes(x = name), data = let.df)
ggplot(data = let.df, mapping = aes(x = name)) + stat_count()
let.df.sum <- data.frame(name = letters, summary = 1:26)
ggplot() + geom_bar(mapping = aes(x = name, y = ..count..), data = let.df)
ggplot() + geom_bar(mapping = aes(x = name, y = summary), data = let.df.sum, stat = "identity")
ggplot() + stat_identity(mapping = aes(x = name, y = summary), data = let.df.sum, geom = "bar")
View(let.df.sum)
library(ggplot2)
library(ggplot2)
rand()
runif(1)
runif(1)*10
runif(1)*10%%2
runif(1)*10%2
runif(1)*10%/%2
runif(1)*10%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
clear()
clear
(runif(1)*10)%/%2
runif(1)*10
runif(1)*10)
(runif(1)*10)%%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*13)%/%2
(runif(1)*13)%/%2
(runif(1)*13)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
(runif(1)*12.1)%/%2
runif(1)
runif(1)*1
runif(1)*10
(runif(1)*10) %/% 2
(runif(1)*8) %/% 2
(runif(1)*8) %/% 2
(runif(1)*8) %/% 2
(runif(1)*8) %/% 2
(runif(1)*8) %/% 2
(runif(1)*8) %/% 2
(runif(1)*8) %/% 2
(runif(1)*8) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
clear()
clear
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
## load the library
library("ATACseqQC")
install.packages("cli")
install.packages("Rtools")
install.packages("tidyverse")
install.packages("BiocManager")
BiocManager::install("ATACseqQC")
a
install.packages("cli")
install.packages("Rtools")
install.packages("tidyverse")
install.packages("BiocManager")
BiocManager::install("ATACseqQC")
a
library("ATACseqQC")
estimateLibComplexity(readsDupFreq(bamfile, index=bamfile))
fragSize <- fragSizeDist(bamfile, bamfile.labels)
install.packages("cli")
install.packages("Rtools")
install.packages("tidyverse")
install.packages("BiocManager")
install.packages("BiocManager")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse")
install.packages("tidyverse", lib="C:/Program Files/R/R-4.2.2/library")
install.packages("tidyverse", lib = "C:/Program Files/R/R-4.2.2/library")
install.packages("BiocManager", lib="C:/Program Files/R/R-4.2.2/library")
BiocManager::install("ATACseqQC")
library("ATACseqQC")
remove.packages("cli")
library(cli)
remove.packages("cli")
BiocManager::install("ATACseqQC")
library("ATACseqQC")
library(cli)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
install.packages("BiocManager"0
install.packages("BiocManager")
install.packages("BiocManager")
BiocManager::install("DESeq2")
runif(1)
(runif(1)*12)%%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1))*10 %/%2
(runif(1))*10%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*10)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
(runif(1)*12)%/%2
clear
clear()
clear()
(runif(1)*12)%/%2
(runif(1)*12)%/%2
library(tidyverse)
rnorm(1))
rnorm(1)
rnorm(10)
rnorm(1, 0.999,5.001)
rnorm(1, 0.999,5.001)
runif()
runif(1)
runif(2)
runif(1)*10
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*10) %/% 2
(runif(1)*11) %/% 2
(runif(1)*11) %/% 2
(runif(1)*11) %/% 2
(runif(1)*11) %/% 2
(runif(1)*11) %/% 2
(runif(1)*11) %/% 2
(runif(1)*11) %/% 2
(runif(1)*11) %/% 2
(runif(1)*11) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
(runif(1)*12) %/% 2
install.packages(“qqman”)
install.packages("qqman)
""
)
install.packages("qqman")
library(qqman)
library('qqman')
library(tidyverse)
library(ggplot2)
library(VennDiagram)
setwd("/Users/Oscar/Desktop/Emerson_Lab_Work/SV-project")
setwd("/Users/Oscar/Desktop/Emerson_Lab_Work/SV-project")
tab <- read.table("stats-nv107.3.tsv", header = FALSE)
colnames(tab) <- c("prog", "chr", "start", "type", "length")
levels(as.factor(tab$prog))
levels(as.factor(tab$type))
tab = tab %>% mutate(abs_length=abs(as.numeric(tab$length))) %>%
mutate(new_type=recode(type,"DUP:INT"="DUP", "DUP:TANDEM"="DUP"))
tab2 = tab %>% na.omit()
tab3 = tab2 %>% filter(prog=="sniffles")
levels(as.factor(tab3$prog))
levels(as.factor(tab3$type))
tab3 = tab %>% filter(prog=="sniffles")
levels(as.factor(tab3$prog))
levels(as.factor(tab3$type))
p1 <- ggplot(data=tab)
p1 + geom_bar(mapping=aes(x=new_type))
p1
p1 <- ggplot(data=tab)
p1 + geom_bar(mapping=aes(x=new_type), stat = 'bin')
p1 <- ggplot(data=tab)
p1 + geom_bar(mapping=aes(x=new_type), stat = 'count')
p1
p1 <- ggplot(data=tab)
p1 + geom_bar(aes(x=new_type), stat = 'count')
p1
p1 <- ggplot(data=tab)
p1 + geom_bar(mapping=aes(x=chr), stat = 'count')
p1
tab3 = tab %>% filter(prog=="sniffles")
levels(as.factor(tab3$prog))
levels(as.factor(tab3$type))
summary(tab3$abs_length)
sum(tab3$abs_length)
p1 <- ggplot(data=tab3)
p1 + geom_bar(mapping=aes(x=type), stat = 'count')
p1
p1 <- ggplot(data=tab)
p1 + geom_bar(mapping=aes(x=as.factor(chr)), stat = 'count')
p1
p1 <- ggplot(data=tab,mapping=aes(x=as.factor(chr)))
p1 + geom_bar(stat = 'count')
p1
p1 <- ggplot(data=tab,mapping=aes(x=as.factor(chr)))
p1 + geom_bar()
p1
p1 <- ggplot(data=tab,mapping=aes(x=as.factor(chr)))
+ geom_bar()
p1 <- ggplot(data=tab,mapping=aes(x=as.factor(chr))) + geom_bar()
p1
p1 <- ggplot(data=tab) + geom_bar(mapping=aes(x=as.factor(chr)))
p1
p1 <- ggplot(data=tab) + geom_bar(mapping=aes(x=as.factor(chr)))
p1
p1 <- ggplot(data=tab) + geom_bar(mapping=aes(x=chr))
p1
p1 <- ggplot(data=tab)
p1 + geom_bar(mapping=aes(x=chr))
p1
p1 <- ggplot(data=tab)
p1 + geom_bar(mapping=aes(x=chr))
p1 <- ggplot(data=tab) + geom_bar(mapping=aes(x=new_type)) +
p1
p1 <- ggplot(data=tab) + geom_bar(mapping=aes(x=new_type))
p1
p1 <- ggplot(data=tab) + geom_bar(mapping=aes(x=new_type))+
scale_y_log10()
p1
p1 <- ggplot(data=tab) + geom_bar(mapping=aes(x=new_type))+
scale_y_sqrt()
p1
p1 <- ggplot(data=tab) + geom_bar(mapping=aes(x=new_type, fill=prog))+
scale_y_sqrt()
p1
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type, fill=prog))+
scale_y_sqrt()
p1
p1 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type, fill=prog))+
scale_y_sqrt()
p1
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type, fill=prog))+
scale_y_sqrt()
p1
p1 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type, fill=green))+
scale_y_sqrt()
p1
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type, fill=prog))+
scale_y_sqrt()
p1
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type, fill="green3"))+
scale_y_sqrt()
p2
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type, fill='green3'))+
scale_y_sqrt()
p2
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type))+
scale_y_sqrt()
p2
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'red')+
scale_y_sqrt()
p2
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt()
p2
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type, fill=prog))+
scale_y_sqrt()
p1
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type), fill = 'orange3')+
scale_y_sqrt()
p1
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt()
p2
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")
p2
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type), fill = 'orange3')+
scale_y_sqrt()+labs(title="sniffles", x ="SV type", y = "Count")
p1
png("2_1-sniffles_count.png", width = 6000, height = 2500)
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type), fill = 'orange3')+
scale_y_sqrt()+labs(title="sniffles", x ="SV type", y = "Count")
p1
dev.off()
png("2_2-cuteSV_count.png", width = 6000, height = 2500)
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")
p2
dev.off()
png("2_1-sniffles_count.png", width = 1200, height = 1200)
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type), fill = 'orange3')+
scale_y_sqrt()+labs(title="sniffles", x ="SV type", y = "Count")+
theme(text = element_text(size = 30))
p1
dev.off()
png("2_2-cuteSV_count.png", width = 1200, height = 1200)
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")+
theme(text = element_text(size = 30))
p2
dev.off()
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type), fill = 'orange3')+
scale_y_sqrt()+labs(title="sniffles", x ="SV type", y = "Count")+
theme(text = element_text(size = 30)) + scale_y_continuous(limits = c(0,6000))
p1
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")+
theme(text = element_text(size = 30)) + scale_y_continuous(limits = c(0,6000))
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")+
theme(text = element_text(size = 30)) + scale_y_continuous(limits = c(0,6000))
p2
png("2_1-sniffles_count.png", width = 1200, height = 1200)
p1 <- ggplot(data=tab%>%filter(prog=="sniffles")) + geom_bar(mapping=aes(x=new_type), fill = 'orange3')+
scale_y_sqrt()+labs(title="sniffles", x ="SV type", y = "Count")+
theme(text = element_text(size = 30)) + scale_y_continuous(limits = c(0,6000))
p1
dev.off()
png("2_2-cuteSV_count.png", width = 1200, height = 1200)
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")+
theme(text = element_text(size = 30)) + scale_y_continuous(limits = c(0,6000))
p2
dev.off()
library(gridExtra)
library(grid)
lay <- c(1,2)
grid.arrange(P1,P2, layout_matrix = lay)
grid.arrange(p1,p2, layout_matrix = lay)
lay <- c(1,2)
grid.arrange(p1, p2, ncol=2)
grid.arrange(p1,p2, layout_matrix = lay)
p2
lay <- rbind(c(1,2),c(1,2))
grid.arrange(p1, p2, ncol=2)
grid.arrange(p1,p2, layout_matrix = lay)
grid.arrange(p1,p2, layout_matrix = lay,top="top label", bottom="bottom\nlabel",
left="left label", right="right label")
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")+
theme(text = element_text(size = 30)) + scale_y_continuous(limits = c(0,6000)) +
annotate(geom="text", x=15, y=12, label="(a)",size=8,family="serif")
p2
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")+
theme(text = element_text(size = 30)) + scale_y_continuous(limits = c(0,6000)) +
annotate(geom="text", x=5, y=12, label="(a)",size=8)
p2
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")+
theme(text = element_text(size = 30)) + scale_y_continuous(limits = c(0,6000)) +
annotate(geom="text", x=0, y=0, label="(a)",size=8)
p2
p2 <- ggplot(data=tab%>%filter(prog=="cuteSV")) + geom_bar(mapping=aes(x=new_type), fill = 'green4')+
scale_y_sqrt() +labs(title="cuteSV", x ="SV type", y = "Count")+
theme(text = element_text(size = 30)) + scale_y_continuous(limits = c(0,6000)) +
annotate(geom="text", x=-5, y=-5, label="(a)",size=8)
p2
